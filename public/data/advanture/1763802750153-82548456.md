# Clinical User Update API Documentation

## Endpoint
```
PUT /api/clinical-users/:id
```

## Description
Allows a **clinical user** to update a **patient user's** profile securely.  
Only non-credential health-related fields can be updated.

---

## Authentication
```
Authorization: Bearer <JWT_TOKEN>
```

Only users with:
```
role: "clinicals"
```
are allowed.

---

## Allowed Fields to Update
- username  
- age  
- gender  
- address  
- diagnosis  
- primary_physician_surgeon  
- procedureInformation  
- baselineAbiAssessment  
- requiredMonitoring  
- health_data_access  
- camera_access  
- push_notification  
- enable_walk_test  
- is_detailed_profile_completed  

---

## Blocked Fields (Cannot Update)
- email  
- password  
- phone_number  
- role  
- hospital_pin  
- clinical_PIN  
- _id  

---

## Sample Request
```
PUT /api/clinical-users/691890f1bbb97863bd57e4c1
```

### JSON Body
```json
{
  "username": "Patient One Updated",
  "age": 48,
  "gender": "male",
  "address": "New Delhi, India",
  "diagnosis": "Updated Peripheral Artery Disease",
  "primary_physician_surgeon": "Dr. Clinical Updated",
  "procedureInformation": {
    "procedurePerformed": "Stent Placement",
    "procedureDate": "2025-01-10",
    "dischargeDate": "2025-01-14",
    "comorbidities": ["diabetes", "hypertension"],
    "expectedRecoveryPeriod": "8 weeks"
  },
  "baselineAbiAssessment": {
    "leftAbi": 0.92,
    "rightAbi": 0.88,
    "measurementDate": "2025-11-15",
    "comments": "Improvement noted after procedure"
  },
  "requiredMonitoring": {
    "vitalSigns": true,
    "mealPainDiary": true,
    "weightMonitoring": true,
    "medicalRecordUploads": true,
    "fastStrokeChecks": false,
    "compressionSockAdherence": true,
    "woundIncisionMonitoring": true,
    "sixMinUteWalkTest": false
  },
  "health_data_access": true,
  "camera_access": true,
  "push_notification": true,
  "is_detailed_profile_completed": true
}
```

---

## Sample Success Response
```json
{
  "success": true,
  "message": "User updated successfully.",
  "data": {
    "_id": "691890f1bbb97863bd57e4c1",
    "username": "Patient One Updated",
    "diagnosis": "Updated Peripheral Artery Disease",
    "health_data_access": true
  }
}
```

---

## Error Responses

### 403 – Unauthorized
```
{
  "success": false,
  "message": "Access denied. Only clinicals can update user data."
}
```

### 404 – User Not Found
```
{
  "success": false,
  "message": "User not found or not under this clinical."
}
```

### 400 – Invalid Fields
```
{
  "success": false,
  "message": "No valid fields provided to update."
}
```

---

## Notes
- Only clinicals belonging to the same **hospital_pin** and **clinical_PIN** as the user can update them.
- All blocked fields are stripped automatically for security.
